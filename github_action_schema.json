{
    "openapi": "3.1.0",
    "info": {
        "title": "GitHub Memory",
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "https://api.github.com"
        }
    ],
    "components": {
        "securitySchemes": {
            "githubOAuth": {
                "type": "oauth2",
                "flows": {
                    "authorizationCode": {
                        "authorizationUrl": "https://github.com/login/oauth/authorize",
                        "tokenUrl": "https://github.com/login/oauth/access_token",
                        "scopes": {
                            "repo": "Full control of private repositories",
                            "read:user": "Read user profile"
                        }
                    }
                }
            }
        },
        "schemas": {
            "CreateRepoRequest": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "enum": [
                            "career-corpus-memory"
                        ]
                    },
                    "private": {
                        "type": "boolean",
                        "enum": [
                            true
                        ]
                    },
                    "auto_init": {
                        "type": "boolean",
                        "enum": [
                            true
                        ]
                    }
                },
                "required": [
                    "name",
                    "private",
                    "auto_init"
                ]
            },
            "SetRepoTopicsRequest": {
                "type": "object",
                "properties": {
                    "names": {
                        "type": "array",
                        "minItems": 1,
                        "maxItems": 1,
                        "items": {
                            "type": "string",
                            "enum": [
                                "career-corpus-memory"
                            ]
                        }
                    }
                },
                "required": [
                    "names"
                ]
            },
            "UpsertFileRequest": {
                "type": "object",
                "properties": {
                    "message": {
                        "type": "string"
                    },
                    "content": {
                        "type": "string",
                        "description": "Base64-encoded file content",
                        "minLength": 1,
                        "contentEncoding": "base64"
                    },
                    "sha": {
                        "type": "string",
                        "description": "Required when updating an existing file"
                    }
                },
                "required": [
                    "message",
                    "content"
                ]
            },
            "CreateGitBlobRequest": {
                "type": "object",
                "properties": {
                    "content": {
                        "type": "string",
                        "minLength": 1
                    },
                    "encoding": {
                        "type": "string",
                        "enum": [
                            "utf-8"
                        ]
                    }
                },
                "required": [
                    "content",
                    "encoding"
                ]
            },
            "CreateGitTreeRequest": {
                "type": "object",
                "properties": {
                    "base_tree": {
                        "type": "string"
                    },
                    "tree": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "path": {
                                    "type": "string"
                                },
                                "mode": {
                                    "type": "string",
                                    "enum": [
                                        "100644"
                                    ]
                                },
                                "type": {
                                    "type": "string",
                                    "enum": [
                                        "blob"
                                    ]
                                },
                                "sha": {
                                    "type": [
                                        "string",
                                        "null"
                                    ]
                                }
                            },
                            "required": [
                                "path",
                                "sha"
                            ]
                        }
                    }
                },
                "required": [
                    "base_tree",
                    "tree"
                ]
            },
            "CreateGitCommitRequest": {
                "type": "object",
                "properties": {
                    "message": {
                        "type": "string"
                    },
                    "tree": {
                        "type": "string"
                    },
                    "parents": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "minItems": 1
                    }
                },
                "required": [
                    "message",
                    "tree",
                    "parents"
                ]
            },
            "UpdateGitRefRequest": {
                "type": "object",
                "properties": {
                    "sha": {
                        "type": "string"
                    },
                    "force": {
                        "type": "boolean",
                        "enum": [
                            false
                        ]
                    }
                },
                "required": [
                    "sha",
                    "force"
                ]
            }
        }
    },
    "security": [
        {
            "githubOAuth": [
                "repo",
                "read:user"
            ]
        }
    ],
    "paths": {
        "/user": {
            "get": {
                "operationId": "getAuthenticatedUser",
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                }
            }
        },
        "/user/repos": {
            "post": {
                "operationId": "createMemoryRepo",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateRepoRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    },
                    "422": {
                        "description": "Validation failed (often malformed base64 or invalid request payload)"
                    }
                }
            }
        },
        "/repos/{owner}/career-corpus-memory": {
            "get": {
                "operationId": "getMemoryRepo",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            }
        },
        "/repos/{owner}/career-corpus-memory/topics": {
            "put": {
                "operationId": "setMemoryRepoTopics",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/SetRepoTopicsRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated"
                    }
                }
            }
        },
        "/repos/{owner}/career-corpus-memory/git/ref/heads/{branch}": {
            "get": {
                "operationId": "getBranchRef",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "branch",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Not found"
                    },
                    "409": {
                        "description": "Conflict"
                    }
                }
            }
        },
        "/repos/{owner}/career-corpus-memory/git/commits/{commit_sha}": {
            "get": {
                "operationId": "getGitCommit",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "commit_sha",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            }
        },
        "/repos/{owner}/career-corpus-memory/git/blobs": {
            "get": {
                "operationId": "getGitBlob",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "sha",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            },
            "post": {
                "operationId": "createGitBlob",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateGitBlobRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    },
                    "404": {
                        "description": "Not found"
                    },
                    "422": {
                        "description": "Validation failed"
                    }
                }
            }
        },
        "/repos/{owner}/career-corpus-memory/git/trees": {
            "get": {
                "operationId": "getGitTree",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "tree_sha",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "recursive",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "enum": [
                                0,
                                1
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            },
            "post": {
                "operationId": "createGitTree",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateGitTreeRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    },
                    "404": {
                        "description": "Not found"
                    },
                    "422": {
                        "description": "Validation failed"
                    }
                }
            }
        },
        "/repos/{owner}/career-corpus-memory/git/commits": {
            "post": {
                "operationId": "createGitCommit",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateGitCommitRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    },
                    "404": {
                        "description": "Not found"
                    },
                    "422": {
                        "description": "Validation failed"
                    }
                }
            }
        },
        "/repos/{owner}/career-corpus-memory/git/refs/heads/{branch}": {
            "patch": {
                "operationId": "updateBranchRef",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "branch",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UpdateGitRefRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated"
                    },
                    "404": {
                        "description": "Not found"
                    },
                    "409": {
                        "description": "Conflict"
                    },
                    "422": {
                        "description": "Validation failed"
                    }
                }
            }
        },
        "/repos/{owner}/career-corpus-memory/contents/preferences.json": {
            "get": {
                "operationId": "readPreferencesJson",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            },
            "put": {
                "operationId": "upsertPreferencesJson",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UpsertFileRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated"
                    },
                    "201": {
                        "description": "Created"
                    }
                }
            }
        },
        "/repos/{owner}/career-corpus-memory/contents/career_corpus.json": {
            "get": {
                "operationId": "readCareerCorpusJson",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "404": {
                        "description": "Not found"
                    }
                }
            },
            "put": {
                "operationId": "upsertCareerCorpusJson",
                "parameters": [
                    {
                        "name": "owner",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UpsertFileRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated"
                    },
                    "201": {
                        "description": "Created"
                    },
                    "422": {
                        "description": "Validation failed (often malformed base64 or invalid request payload)"
                    }
                }
            }
        }
    }
}
